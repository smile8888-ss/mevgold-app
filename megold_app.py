import requests
import json
# import libraries ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô bs4, datetime) ‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢

# ==========================================
# 1. ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡πÄ‡∏≠‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏µ‡πâ‡∏°‡∏≤‡πÉ‡∏™‡πà)
# ==========================================
# ‡πÄ‡∏≠‡∏≤ App ID (‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏≤‡∏ß) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ü‡∏±‡∏ô‡∏´‡∏ô‡∏π
ONESIGNAL_APP_ID = "f2770b48-2c38-4b73-9ba8-6c11469fe53e" 

# ‡πÄ‡∏≠‡∏≤ REST API Key (‡∏£‡∏´‡∏±‡∏™‡∏™‡∏±‡πâ‡∏ô) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ü‡∏±‡∏ô‡∏´‡∏ô‡∏π (‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Basic ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ 1 ‡∏ó‡∏µ)
ONESIGNAL_API_KEY = "Basic os_v2_app_6j3qwsbmhbfxhg5inqiunh7fh34bpu67lhdun65mziwhnhzcliu7alpisw2qtefk37kay27sjsgahjgegupmgkks6sb6ijeuckmg5vq"

# ==========================================
# 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏≠‡∏õ
# ==========================================
def send_push_to_app(buy_price, sell_price):
    header = {
        "Content-Type": "application/json; charset=utf-8",
        "Authorization": ONESIGNAL_API_KEY
    }
    
    # ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á
    payload = {
        "app_id": ONESIGNAL_APP_ID,
        "included_segments": ["All"], # ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô
        "headings": {"en": "‡∏ó‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤! üîî"},
        "contents": {"en": f"‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠: {buy_price} | ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å: {sell_price}"}
    }
    
    try:
        req = requests.post("https://onesignal.com/api/v1/notifications", headers=header, json=payload)
        print("Status Code:", req.status_code)
        print("Response:", req.text)
    except Exception as e:
        print("Error:", e)

# ==========================================
# 3. ‡∏™‡πà‡∏ß‡∏ô‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
# ==========================================
def check_gold_price():
    print("Checking Gold Price for MeGold App...")
    
    # -------------------------------------------------------
    # ‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:
    # ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ Logic ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤ (mevgold.py) 
    # ‡∏°‡∏≤‡πÅ‡∏õ‡∏∞‡∏ó‡∏±‡∏ö‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏à‡∏ô‡πÑ‡∏î‡πâ new_buy, new_sell)
    # -------------------------------------------------------
    
    # ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
    # new_buy = "43000"
    # new_sell = "43100"
    # price_changed = True  # ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
    
    # ‡∏ñ‡πâ‡∏≤ Logic ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ:
    # if price_changed:
    #     print("‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô! ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô...")
    #     send_push_to_app(new_buy, new_sell)
    
    # -------------------------------------------------------

if __name__ == "__main__":
    check_gold_price()
